---
title: "Obermayer_Assignment4"
author: "Alyssa Obermayer"
date: "10/17/2020"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(tidy.opts=list(width.cutoff=60),tidy=TRUE)
```

## *Question 4*

Question 4 looks at genetic drift and the maintenance of genetic diversity. The goal was to find the minimum viable starting population size that provides a 99% chance of preserving both alleles over the course of 100 generations, assuming constant population size. To complete this I took the function for genetic drift with selection that generated p values, the proportion of A1 alleles, and when replicating it 18 times, I also added a loop to do those replications for a sequence of starting populations. With the values generated I plotted a total of 12 starting population scenarios ranging from 4 individuals to 15 individuals and displayed them below.

``` {r}
drift_ns <- function(w11,w12,w22,p0,n,time){    #Function to find p values over time
  p <- p0    #Initial condition is placed in the first position of the p column vector
  for (t in 1:time){    #For every instance in the set of generations
    a1 <- rbinom(2*n,size=1,prob=p[t])    #Draw of alleles
    pd <- sum(a1)/(2*n)    #The ratio of A1 alleles in the total population
    wbar = pd^2*w11+2*pd*(1-pd)*w12+(1-pd)^2*w22    #Selection, Avg fitness
    pprime = (pd*w11 + (1-pd)*w12)*pd/wbar    #Selection, p(t+1)
    p <- c(p, pprime)    #Column binding pprime values under the original p value
  }
  return(p) 
}

set.seed(1)
n0s <- seq(4,15,1)
e <- NULL
for (n in n0s){    #For every n in the sequence of starting population sizes
  for (i in 1:18){    #Run 18 replicates of the function over 100 generations
    e <- cbind(e,drift_ns(w11=0.5,w12=1,w22=0.5,p0=0.5,n,time=100))    #Column bind the results of the 18 sequences to 'e'
  }
}

par(mfrow=c(2,2)) #Combine following 4 graphs into one output

colors<-rainbow(216)
plot(e[,1],col=colors[1],lwd=1.5,type="l",ylim=c(0,1),xlab="Generation",ylab="Proportion A1",main="Starting Population of 4")
for (i in 2:18){
  lines(e[,i],col=colors[i],lwd=1.5)
}

plot(e[,19],col=colors[19],lwd=1.5,type="l",ylim=c(0,1),xlab="Generation",ylab="Proportion A1",main="Starting Population of 5")
for (i in 20:36){
  lines(e[,i],col=colors[i],lwd=1.5)
}

plot(e[,37],col=colors[37],lwd=1.5,type="l",ylim=c(0,1),xlab="Generation",ylab="Proportion A1",main="Starting Population of 6")
for (i in 38:54){
  lines(e[,i],col=colors[i],lwd=1.5)
}

plot(e[,55],col=colors[55],lwd=1.5,type="l",ylim=c(0,1),xlab="Generation",ylab="Proportion A1",main="Starting Population of 7")
for (i in 56:72){
  lines(e[,i],col=colors[i],lwd=1.5)
}

par(mfrow=c(2,2))

plot(e[,73],col=colors[73],lwd=1.5,type="l",ylim=c(0,1),xlab="Generation",ylab="Proportion A1",main="Starting Population of 8")
for (i in 74:90){
  lines(e[,i],col=colors[i],lwd=1.5)
}

plot(e[,91],col=colors[91],lwd=1.5,type="l",ylim=c(0,1),xlab="Generation",ylab="Proportion A1",main="Starting Population of 9")
for (i in 92:108){
  lines(e[,i],col=colors[i],lwd=1.5)
}

plot(e[,109],col=colors[109],lwd=1.5,type="l",ylim=c(0,1),xlab="Generation",ylab="Proportion A1",main="Starting Population of 10")
for (i in 110:126){
  lines(e[,i],col=colors[i],lwd=1.5)
}

plot(e[,127],col=colors[127],lwd=1.5,type="l",ylim=c(0,1),xlab="Generation",ylab="Proportion A1",main="Starting Population of 11")
for (i in 128:144){
  lines(e[,i],col=colors[i],lwd=1.5)
}

par(mfrow=c(2,2))

plot(e[,145],col=colors[145],lwd=1.5,type="l",ylim=c(0,1),xlab="Generation",ylab="Proportion A1",main="Starting Population of 12")
for (i in 146:162){
  lines(e[,i],col=colors[i],lwd=1.5)
}

plot(e[,163],col=colors[163],lwd=1.5,type="l",ylim=c(0,1),xlab="Generation",ylab="Proportion A1",main="Starting Population of 13")
for (i in 164:180){
  lines(e[,i],col=colors[i],lwd=1.5)
}

plot(e[,181],col=colors[181],lwd=1.5,type="l",ylim=c(0,1),xlab="Generation",ylab="Proportion A1",main="Starting Population of 14")
for (i in 182:198){
  lines(e[,i],col=colors[i],lwd=1.5)
}

plot(e[,199],col=colors[199],lwd=1.5,type="l",ylim=c(0,1),xlab="Generation",ylab="Proportion A1",main="Starting Population 15")
for (i in 200:216){
  lines(e[,i],col=colors[i],lwd=1.5)
}
```

As seen above, around a starting population size of 12 individuals, the preservation of both alleles over the course of 100 generations is shown, when assuming constant population size, although, in a realistic population, it is very unlikely that the population size would be constant, especially over 100 generations. Demographic stochasticity, as studied in the previous assignment, showed that all populations will go extinct eventually and given a smaller population, that risk of extinction is greatly accentuated, though migration may offset this risk. Small populations also show a risk in genetic drift, where, without selection or mutations the allele frequency will begin to fixate, lowering genetic diversity. In a realistic environment the environment is constantly changing. This can play a role in the genetic diversity which is necessary for individuals to adapt to their environment. This diversity could also play a role in selection if it were to greatly improve the fitness of an individual, which may in turn affect which individuals are fit to survive and mate.

In smaller population sizes, the interaction of genetic drift and demographic stochasticity can have a much larger impact on population changes, when compared to a larger population. This is helpful to take into account when developing conservation management tactics for certain populations that are headed to extinction at a faster rate. Especially when populations become small enough and these stochastic methods play a larger role, there is a strong probability of inbreeding depression occurring due to the dwindling of down genetic diversity when mating occurs. Overall, it is important to monitor the environmental variation, migration, and genetic diversity of populations to better generate models of population level so if they may seem in danger a more proactive approach can be determined to counteract the possibility of extinction.