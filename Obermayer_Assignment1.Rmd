---
title: "Obermayer_Assignment1"
author: "Alyssa Obermayer"
date: "9/5/2020"
output: html_document
---

## **Symbolic Math in R**

To complete the following problems two packages were installed: Ryacas and deSolve.

```{r include = FALSE}
chooseCRANmirror(graphics = FALSE, ind = 1)
knitr::opts_chunk$set(echo = TRUE)
install.packages(c("Ryacas","deSolve"))
library(Ryacas)
library(deSolve)
```

## *Problem 1*

In the first problem we consider an endothermic animal, such as a squirrel in 
this scenario, and adapt the heat flux equation to include a contribution of 
metabolic heat. We are to assume that the metabolism of the squirrel only
provides heat and we ignore sweat and other methods of physiological cooling.

To start, we will use R to solve the heat flux equation for 'b' while taking
metabolic heat into consideration.

```{r include = TRUE}
f = "q - h*(b-a) + m"
F = ysym(f)
be = solve(F,'b')
be
```

Above you can see the process of solving for equilibrium body temperature while
taking metabolic heat into consideration. Since the squirrels metabolism is
thought to only be adding heat to the organism it is a simple addition of the
variable. In the end we obtained the equation for 'b' with the assumption that
heat flux is zero and all other variable are not fluctuating.

## *Problem 2*

For problem 2 we will give these variable values to solve for the maximum solar
input the squirrel can survive at equilibrium and then create a plot comparing
body temperature to the amount of solar radiation. For this scenario we will
assume that the metabolic heat (m) generated by the squirrel is 120 cal/hr and 
the maximum lethal body temperature (b) of that squirrel is 40 degrees Celsius.
Additionally, the air temperature (a) will be given as 18 degrees Celsius and 
the convective heat transfer coefficient (h) will be 50 cal/hr/degree Celsius.

To start, we can go off of the previous heat flux equation, but this time we
will solve it for 'q' when heat flux is equal to zero, which can be seen below.

``` {r include = TRUE}
qe = solve(F,'q')
qe
```

With the derived equation we can now add values to the variables and solve it
quantitatively. By solving for 'q' while the squirrel is at its maximum body
temperature of 40 degrees Celsius we will be able to calculate the amount of 
solar radiation that would be required to push them to their limit.

``` {r include = TRUE}
m = 120; b = 40; a = 18; h = 50
qen = eval(as_r(y_rmvars(qe)))
qen
```

The above evaluation of the equation for 'q' tells us that, when only taking
solar radiation into account, the maximum solar radiation that a squirrel can
survive at equilibrium would be `r eval(as_r(y_rmvars(qe)))` cal/hr. Now we can
take this information and plot it to visualize the correlation of body
temperature and solar radiation, as well as see where 'q' exceeds the threshold.

``` {r include = TRUE}
q <- c(0, 500, 1000)
ben = eval(as_r(y_rmvars(be)))
plot(ben~q, 
     type = "l", 
     xlab = "Solar Radiation (cal/hr)", 
     ylab = "Body Temperature (C)", 
     main = "Body Temperature vs. Solar Radiation")
  abline(h = 40, 
         col = "red")
  points(980, 40, 
         pch = 8, 
         col = "blue")
  text(980, 40,
       "Solar Radiation Threshold",
       pos = 2,
       col = "blue")
```

## *Problem 3*

For the last problem we will conduct a numerical analysis to find the length of
time it would take for a squirrel to reach equilibrium temperature while 
modifying the analysis to take metabolic heat into consideration.

```{r include = TRUE}
bes = (((800+120)/50)+16)
bes <- 34.4
bel = ((800/50)+16)
bel <- 32

model.db <- function(times,y,parms){
  with(as.list(c(y, parms)), {
    db <- (q-h*(b-a)+m)/w
    list(db)
  })
}
t <- seq(from = 0, to = 120, length.out = 30)
b0 <- c(b = 34)
parms <- c(a = 16, h = 50, q = 800, w = 453, m = 120)
outputS <- ode(times = t,
               y = b0,
               func = model.db,
               parms = parms)
outputS

model.db <- function(times,y,parms){
  with(as.list(c(y, parms)), {
    db <- (q-h*(b-a))/w
    list(db)
  })
}
tl <- seq(from = 0, to = 3, length.out = 30)
b0 <- c(b = 34)
parms <- c(a = 16, h = 50, q = 800, w = 10)
outputL <- ode(times = tl,
               y = b0,
               func = model.db,
               parms = parms)
outputL

plot(outputS[,2]~outputS[,1], 
     type = "b", 
     ylab = "Body Temperature (C)", 
     xlab = "Time (hrs)",
     main = "Time for Body Temperature to Reach Equilibrium: Sqirrels vs Lizards")
lines(outputL[,2]~outputL[,1],
      col = "cyan")

plot(outputL[,2]~outputL[,1], 
     type = "b", 
     ylab = "Body Temperature (C)", 
     xlab = "Time (hrs)", 
     main = "Time for Body Temperature to Reach Equilibrium: Lizard Only",
     col = "cyan")

```

Above shows the code to show the change in temperature over time as it adjusts 
to reach equilibrium. Since the weight of the squirrel was not given I assumed 
it would be about a pound which equates to 453 g. As shown in the graphs the 
squirrel takes much longer to reach its equilibrium temperature of 34.4 degrees
celsius than the lizard takes to reach its equilibrium temperature of 32 degrees
celsius. I tried to plot both curves on the same graph but was have trouble with
setting the limits but did show in a separate graph the adjustment via decreasing
in temperature of the lizard to reach equilibrium while in the same conditions
as the squirrel. While the metabolism of the squirrel helps heat it up,
the squirrel is also much larger that the lizard and takes a much longer amount
of time to reach equilibrium temperature at around 103 hours, compared to the
lizard which takes around 3 hours.